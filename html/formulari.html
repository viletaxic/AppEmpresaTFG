<!DOCTYPE html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!--ESTILS DE BOOTSTRAP -->
	<link href="css/bootstrap.min.css" rel="stylesheet"/>
	<link type="text/css" href="css/estil.css" rel="stylesheet"/>
	<script type="text/javascript" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
	<!--ARXIUS JAVASCRIPT DE BOOTSTRAP -->
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/md5.js"></script>
	<script>
		$(document).on("ready", function(){
			document.getElementById('LatY').value = window.localStorage.getItem("LatY");
			document.getElementById('LongX').value = window.localStorage.getItem("LongX");
			
			$("#ferregistre").click(function(){
				var fNom = $("#Nom").val();
				var fDescripcio = $("#Descripcio").val();
				var fLatY = $("#LatY").val();
				var fLongX = $("#LongX").val();
				var fIdEmpresa = window.localStorage.getItem("IdEmpresa");
				if(fNom == ""){
					alert('Nom necessari');
					$("#Nom").focus();
				}else{
					if(fDescripcio == ""){
						alert('Descripció necessaria');
						$("#Descripcio").focus();
					}else{
						$("#Nom").val("");
						$("#Descripcio").val("");
						$("#LatY").val("");
						$("#LongX").val("");
						$.ajax({type: "POST",
						  url:"http://158.109.8.89/php/registre_oferta.php",
						  data:({Nom: fNom, Descripcio: fDescripcio, LatY: fLatY, LongX: fLongX, IdEmpresa: fIdEmpresa}),
						  cache: false,
						  dataType: "text",
						  success: Enviar
						});
						function Enviar(data){
							alert(data);
							location.href="mapa.html";
						}
					}
				}
			});
			
			/*
			var formulari = $("#formulari");

			var LatY = localStorage.getItem("LatY");
			document.getElementById('LatY').value = LatY;

			var LongX = localStorage.getItem("LongX");
			document.getElementById('LongX').value = LongX;
			
			formulari.find("input[name='LatY']").val(LatY);
			formulari.find("input[name='LongX']").val(LongX);
			*/
		});
	</script>
</head>
<body id="Cos">
	<div data-role="header">
			<h1>FORMULARI</h1>
		</div>

		<!--------INICIA FORMULARIO------>
		<div data-role="fieldcontain">
			<label for="Nom">Nom:</label>
			<input type="text" name="Nom" id="Nom" value=""  />
		</div>
		<div data-role="fieldcontain">
			<label for="Descripcio">Descripció:</label>
			<textarea cols="40" rows="8"  name="Descripcio" id="Descripcio" value=""  /></textarea>
		</div>
		<div data-role="fieldcontain">
			<label for="LatY">Latitud:</label>
			<input type="text" disabled="disabled" name="LatY" id="LatY" value=""  />
		</div>
		<div data-role="fieldcontain">
			<label for="LongX">Longitud:</label>
			<input type="text" disabled="disabled" name="LongX" id="LongX" value="" />
		</div>
		<div data-role="fieldcontain">
			<label for="Imagen">Imatge:</label>
			<input name="uploadedfile" type="file" />
		</div>
		<button type="button" data-theme="a" id="ferregistre">Enviar</button>
		<button type="button" onclick="window.location.href='index.html'">Torna a l'inici</button>
		<!--------FIN FORMULARIO------>

		<div data-role="footer" data-position="fixed">

		</div>
			
</body>
</html>
